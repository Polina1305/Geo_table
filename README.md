## Geo_names
-----------------

### Заказчик:

##### Карьерный центр Яндекс Практикум

----------------------
### Описание проекта:
#### Цель:
- Сопоставление произвольных гео названий с унифицированными именами geonames для внутреннего использования Карьерным центром

---------------------------

#### Задачи:

- Создать решение для подбора наиболее подходящих названий с geonames. Например Ереван -> Yerevan
- На примере РФ и стран наиболее популярных для релокации - Беларусь, Армения, Казахстан, Кыргызстан, Турция, Сербия. Города с населением от 15000 человек (с возможностью масштабирования на сервере заказчика)
- Возвращаемые поля geonameid, name, region, country, cosine similarity
- формат данных на выходе: список словарей, например [{dict_1}, {dict_2}, …. {dict_n}] где словарь - одна запись с указанными полями

-------------------------------

#### Задачи опционально:


- возможность настройки количества выдачи подходящих названий (например в параметрах метода)
- коррекция ошибок и опечаток. Например Моченгорск -> Monchegorsk
- хранение в PostgreSQL данных geonames
- хранение векторизованных промежуточных данных в PostgreSQL
- предусмотреть методы для настройки подключения к БД
- предусмотреть метод для инициализации класса (первичная векторизация geonames)
- предусмотреть методы для добавления векторов новых гео названий

**Используемые таблицы с [GeoNames](http://download.geonames.org/export/dump/):**

- [cities15000.txt](http://download.geonames.org/export/dump/cities15000.txt) - all cities with a population > 15000 or capitals (ca 25.000), see 'geoname' table for columns

- [admin1CodesASCII.txt](http://download.geonames.org/export/dump/admin1CodesASCII.txt) -  names in English for admin divisions. Columns: code, name, name ascii, geonameid

- [alternateNamesV2.zip](http://download.geonames.org/export/dump/alternateNamesV2.zip) -  alternate names with language codes and geonameId, file with iso language codes, with new columns from and to 

- [countryInfo.txt](http://download.geonames.org/export/dump/countryInfo.txt) - country information : iso codes, fips codes, languages, capital ,...
                                
- [geo_test.csv](http://download.geonames.org/export/dump/опаньки_нежданчик)  - to check the operation of our model

### Описание документов проекта: 

 - Geo_names.ipynb - файл, содержащий исследование, сравнение, тестирование и выбор оптимальной модели для реализации проекта
 - description.md - описание таблиц, используемых в проекте
 - doc_script.md - документация по применению скрипта
 - geonames_info - информация о таблицах с [GeoNames](http://download.geonames.org/export/dump/)
 - script.py - скрипт для подбора наиболее подходящих названий с geonames
 - requiremenrs.txt - текстовый документ с окружением необходимых для работы с файлом script.py
 - requiremenrs_notebook.txt - текстовый документ с окружением необходимых для работы с файлом Geo_names.ipynb

### Результат работы: 

В данной задаче нам было предложено подобрать наиболее подходящее решение для подбора названий с GeoNames. В работе мы отфильтровали данные по городам РФ и стран наиболее популярных для релокации - Беларусь, Армения, Казахстан, Кыргызстан, Турция, Сербия, с населением от 15000 человек. Отфильтрованные данные были загружены в созданную БД в среде PostgreSQL.

Свою работу мы начали с традиционных подходов(растояние Левенштейна), затем мы выбрали две многоязыковые модели:
- stsb-roberta-large
- LaBSE

LaBSE - была обучена на преобразованных данных в InputExample-ы. Чтобы решить, какую модель мы будем применять мы решили посчитать метрику косинусного растояния по всем городам представленным в тестовом наборе.
Тестовый набор состоял из 345 городов. Все названия городов, которые не совпали на 100% с таргетом по наибольшему косиносному сходству мы просмотрели визуально, верные названия иногда оказывались на вторых местах. Усреднённая точность по всему тесту по модели LABSE составила 0.9252873563218391, а по модели ROBERTA: 0.9195402298850575 что считаем оптимальным и останавили свой выбор на модели LABSE, на основе которой мы написали скрипт по подборунаиболее подходящих названий с geonames  с возможностью внедрения его на сервисе заказчика.
